# Qwen2-7B-Instruct_RAG_anti_hallucinations

–ë–µ–π–∑–ª–∞–π–Ω –Ω–∞ Qwen2-7B-Instruct —Å RAG –∏ –∞–Ω—Ç–∏-–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏—è–º–∏ (–∑–∞–¥–∞—á–∞: LLM hallucinations robustness)


–†–µ—à–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ —É—Å—Ç–æ–π—á–∏–≤—ã–π –±–µ–π–∑–ª–∞–π–Ω –¥–ª—è –∑–∞–¥–∞—á–∏ –≤–æ–ø—Ä–æ—Å‚Äì–æ—Ç–≤–µ—Ç —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –º–æ–¥–µ–ª–∏.

–ß—Ç–æ –≤–Ω—É—Ç—Ä–∏

 ‚Ä¢ LLM: –ª–æ–∫–∞–ª—å–Ω–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π Qwen2-7B-Instruct –≤ 4-bit –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–∏ (BitsAndBytes, device_map="auto"),
inference –∏–¥—ë—Ç —Ü–µ–ª–∏–∫–æ–º –æ—Ñ—Ñ–ª–∞–π–Ω –ø–æ –ª–æ–∫–∞–ª—å–Ω—ã–º –≤–µ—Å–∞–º.

 ‚Ä¢ RAG-—Å–ª–æ–π:
 
 ‚Ä¢ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–∑ KB —á–µ—Ä–µ–∑ SentenceTransformer (paraphrase_multilingual_MiniLM_L12_v2);
 
 ‚Ä¢ FAISS IndexFlatIP –ø–æ–≤–µ—Ä—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤;
 
 ‚Ä¢ –ø–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –≤ –±–∞–∑–µ –∏ –≤–æ–∑–≤—Ä–∞—Ç –≥–æ—Ç–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ sim ‚â• threshold.
 
 ‚Ä¢ –ê–Ω—Ç–∏-–ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä: –ø—Ä–æ—Å—Ç—ã–µ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ –¥–ª—è ‚Äú–ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö‚Äù –≤–æ–ø—Ä–æ—Å–æ–≤
 
(–Ω–µ—Å–æ—Å—Ç—ã–∫–æ–≤–∫–∏ –ø–æ —ç–ø–æ—Ö–∞–º, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º –≤ –∞–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ –∏ —Ç.–ø.) ‚Üí –µ–¥–∏–Ω—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –æ—Ç–≤–µ—Ç.

 ‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è: –µ—Å–ª–∏ KB –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç –∏ –≤–æ–ø—Ä–æ—Å –Ω–µ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π:
 
 ‚Ä¢ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä–æ—Ç–∫–∏–π –ø—Ä–æ–º–ø—Ç –≤–∏–¥–∞:
 
–í–æ–ø—Ä–æ—Å: ... –ï—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω ‚Äî "–Ω–µ –∑–Ω–∞—é".;

 ‚Ä¢ –º–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç —Å –∂—ë—Å—Ç–∫–∏–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –ø–æ –¥–ª–∏–Ω–µ –∏ temperature=0.01;
 
 ‚Ä¢ –µ—Å–ª–∏ –º–æ–¥–µ–ª—å –Ω–µ —É–≤–µ—Ä–µ–Ω–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è "–Ω–µ –∑–Ω–∞—é".
 
 ‚Ä¢ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤:
 
 ‚Ä¢ –≤–æ–ø—Ä–æ—Å—ã –±–∞—Ç—á–∞—Ç—Å—è –ø–æ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–º—É —Å—Ö–æ–¥—Å—Ç–≤—É —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤;
 
 ‚Ä¢ –¥–ª—è –±–ª–∏–∑–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω –æ–±—â–∏–π –æ—Ç–≤–µ—Ç;
 
 ‚Ä¢ –≤–≤–µ–¥—ë–Ω group_cache –ø–æ hash-–≥—Ä—É–ø–ø –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤.

–°—Ç–∞—Ç—É—Å

–≠—Ç–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ –±–µ–π–∑–ª–∞–π–Ω–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π –ø–∞–π–ø–ª–∞–π–Ω –Ω–∞ Qwen + RAG, –∫–æ—Ç–æ—Ä—ã–π:

 ‚Ä¢ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è (—É–ª—É—á—à–µ–Ω–∏–µ KB, –ø–æ—Ä–æ–≥–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞, –±–æ–ª–µ–µ —Ç–æ–Ω–∫–∏–π –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –∏ —Ç.–ø.).

üß† –í–∞–∂–Ω–æ –ø—Ä–æ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π

–ö–∞—á–µ—Å—Ç–≤–æ –±–µ–π–∑–ª–∞–π–Ω–∞ —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è KB JSON.

–î–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ RAG –Ω—É–∂–Ω–æ:

 ‚Ä¢ —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–∞—è –±–∞–∑–∞ —Ñ–∞–∫—Ç–æ–≤ –≤ kb.json,
 
 ‚Ä¢ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã question ‚Üí answer,
 
 ‚Ä¢ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ —á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö.

–¢–µ–∫—É—â–∏–π –±–µ–π–∑–ª–∞–π–Ω ‚Äî —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ Qwen2-7B-Instruct –∏ FAISS, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç F1 –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0.3‚Äì0.55. –≠—Ç–æ –ø—Ä–∏–º–µ—Ä–Ω–æ 40‚Äì55% –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç SOTA, –∑–Ω–∞—á–∏—Ç —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞, KB –∏ –ø–æ—Ä–æ–≥–æ–≤.

–¶–µ–ª—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è ‚Äî –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∏ –¥–∞–ª—å–Ω–µ–π—à–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å —É–ª—É—á—à–µ–Ω–∏–µ–º F1-score, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –∑–∞–¥–∞—á Churn/ID/QA –≤ ML.
